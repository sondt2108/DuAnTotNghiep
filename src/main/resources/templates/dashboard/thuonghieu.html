<!DOCTYPE html>
<html>
<head>
<!-- Title -->
<title>Products | Graindashboard UI Kit</title>

<meta charset="utf-8">
<meta name="viewport"
	content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta http-equiv="x-ua-compatible" content="ie=edge">

<!-- Favicon -->
<link rel="shortcut icon" href="/asset/img/favicon.png">

<link rel="stylesheet"
	href="/asset/dashboard/css/graindashboard.css">
<script
	src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<style type="text/css">
#them {
	margin-top: 20px;
	margin-bottom: 20px;
	margin-left: 5px;
	border-radius: 3px;
	font-size: 18px;
	background-color: white;
	color: black;
	border: 2px solid #265df1;
	margin-left: 5px;
}

#them:hover {
	background-color: #265df1;
	color: white;
}
</style>
</head>

<body class="has-sidebar has-fixed-sidebar-and-header">
	<!-- Header -->
	<th:block th:replace="/dashboard/fragments :: header">

	</th:block>
	
	<!-- End Header -->

	<main class="main">
		<!-- Sidebar Nav -->
		<aside id="sidebar" class="js-custom-scroll side-nav">
			<ul id="sideNav" class="side-nav-menu side-nav-menu-top-level mb-0">
				<!-- Title -->
				<li class="sidebar-heading h6">Dashboard</li>
				<!-- End Title -->

				<!-- Dashboard -->
				<li class="side-nav-menu-item"><a
					class="side-nav-menu-link media align-items-center" href="/admin/dashboard"> <span
						class="side-nav-menu-icon d-flex mr-3"> <i
							class="gd-dashboard"></i>
					</span> <span class="side-nav-fadeout-on-closed media-body">Dashboard</span>
				</a></li>
				<!-- End Dashboard -->

				<!-- Documentation -->
				<li class="side-nav-menu-item"><a
					class="side-nav-menu-link media align-items-center" href="#"
					target="_blank"> <span class="side-nav-menu-icon d-flex mr-3">
							<i class="gd-file"></i>
					</span> <span class="side-nav-fadeout-on-closed media-body">Documentation</span>
				</a></li>
				<!-- End Documentation -->

				<!-- Title -->
				<li class="sidebar-heading h6">Examples</li>
				<!-- End Title -->

				<li
				class="side-nav-menu-item side-nav-has-menu"
			  >
				<a
				  class="side-nav-menu-link media align-items-center"
				  href="#"
				  data-target="#subOrder"
				>
				  <span class="side-nav-menu-icon d-flex mr-3">
					<i class="gd-shopping-cart"></i>
				  </span>
				  <span class="side-nav-fadeout-on-closed media-body">Đặt hàng</span>
				  <span class="side-nav-control-icon d-flex">
					<i class="gd-angle-right side-nav-fadeout-on-closed"></i>
				  </span>
				  <span
					class="side-nav__indicator side-nav-fadeout-on-closed"
				  ></span>
				</a>
	  
				<!-- order: subOrder -->
				<ul
				  id="subOrder"
				  class="side-nav-menu side-nav-menu-second-level mb-0"
				>
				  <li class="side-nav-menu-item">
					<a class="side-nav-menu-link" href="/admin/order"
					  >Danh sách đặt hàng</a
					>
				  </li>
				</ul>
				<!-- End order: subORDER -->
			  </li>

				<!-- Users -->
				<li class="side-nav-menu-item side-nav-has-menu"><a
					class="side-nav-menu-link media align-items-center" href="#"
					data-target="#subUsers"> <span
						class="side-nav-menu-icon d-flex mr-3"> <i class="gd-user"></i>
					</span> <span class="side-nav-fadeout-on-closed media-body">Người dùng</span> <span
						class="side-nav-control-icon d-flex"> <i
							class="gd-angle-right side-nav-fadeout-on-closed"></i>
					</span> <span class="side-nav__indicator side-nav-fadeout-on-closed"></span>
				</a> <!-- Users: subUsers -->
					<ul id="subUsers"
						class="side-nav-menu side-nav-menu-second-level mb-0">
						<li class="side-nav-menu-item "><a class="side-nav-menu-link"
							href="/admin/customer">Khách hàng</a></li>
						<li class="side-nav-menu-item "><a class="side-nav-menu-link"
							href="/admin/user">Người dùng</a></li>
					</ul> <!-- End Users: subUsers --></li>
				<!-- End Users -->

				<!-- Products -->

				<li class="side-nav-menu-item side-nav-has-menu "><a
					class="side-nav-menu-link media align-items-center" href="#"
					data-target="#subProducts"> <span
						class="side-nav-menu-icon d-flex mr-3"> <i
							class="gd-package"></i>
					</span> <span class="side-nav-fadeout-on-closed media-body">Sản
							phẩm</span> <span class="side-nav-control-icon d-flex"> <i
							class="gd-angle-right side-nav-fadeout-on-closed"></i>
					</span> <span class="side-nav__indicator side-nav-fadeout-on-closed"></span>
				</a> <!-- Products: subProducts -->
					<ul id="subProducts"
						class="side-nav-menu side-nav-menu-second-level mb-0">
						<li class="side-nav-menu-item"><a class="side-nav-menu-link"
							href="/admin/product">Sản Phẩm</a></li>
						<li class="side-nav-menu-item"><a class="side-nav-menu-link"
							href="/admin/category">Loại sản phẩm</a></li>
						<li class="side-nav-menu-item"><a class="side-nav-menu-link"
							href="/admin/warehouse-receipt">Hóa đơn</a></li>
					</ul> <!-- End Products: subProducts --></li>

				<!-- End Products -->
				<li class="side-nav-menu-item side-nav-has-menu active"><a
					class="side-nav-menu-link media align-items-center" href="#"
					data-target="#subCategory"> <span
						class="side-nav-menu-icon d-flex mr-3"> <i class="gd-list"></i>
					</span> <span class="side-nav-fadeout-on-closed media-body">Phân
							phối</span> <span class="side-nav-control-icon d-flex"> <i
							class="gd-angle-right side-nav-fadeout-on-closed"></i>
					</span> <span class="side-nav__indicator side-nav-fadeout-on-closed"></span>
				</a> <!-- category: subcategory -->
					<ul id="subCategory"
						class="side-nav-menu side-nav-menu-second-level mb-0" style="display: block">

						<li class="side-nav-menu-item"><a class="side-nav-menu-link"
							href="/admin/supplier">Nhà cung cấp</a></li>
						<li class="side-nav-menu-item active"><a class="side-nav-menu-link"
							href="/admin/trademark">Thương hiệu</a></li>
					</ul> <!-- End category: subCategory --> <!-- End category: subCategory -->
				</li>
			</ul>
		</aside>
		<!-- End Sidebar Nav -->

		<div class="content">
			<div class="py-4 px-3 px-md-4">
				<div class="card mb-3 mb-md-4">

					<div class="card-body">
						<!-- Breadcrumb -->
						<nav class="d-none d-md-block" aria-label="breadcrumb">
							<ol class="breadcrumb">
								<li class="breadcrumb-item"><a href="#"></a>Phân phối</li>
								<li class="breadcrumb-item active" aria-current="page">Thương
									Hiệu
							</ol>
						</nav>
						<!-- End Breadcrumb -->

						<div class="mb-3 mb-md-4 d-flex justify-content-between">
							<div class="h3 mb-0">Thương Hiệu</div>
						</div>

						<button id="them">
							<b>+ Thêm</b>
						</button>
						<!-- Users -->
						<div class="table-responsive-xl">
							<table class="table table-striped  table-sm">
								<thead>
									<tr>
										<th class="font-weight-semi-bold border-top-0 py-2">Tên
											thương hiệu</th>
										<th class="font-weight-semi-bold border-top-0 py-2">Sửa Xóa</th>
										
									</tr>
								</thead>
								<tbody id="tableBody">

								</tbody>
							</table>
							
						</div>
						<!-- End Users -->
					</div>
				</div>
			</div>

			<!-- Modal -->
			<div class="modal fade" id="editModal" tabindex="-1"
				aria-labelledby="exampleModalLabel" aria-hidden="true">
				<div class="modal-dialog">
					<div class="modal-content">
						<div class="modal-header">
							<h5 class="modal-title" id="exampleModalLabel"><b>Thương hiệu</b></h5>
							<button type="button" class="close" data-dismiss="modal"
								aria-label="Close">
								<span aria-hidden="true">&times;</span>
							</button>
						</div>
						<div class="modal-body">
							<form id="editForm"></form>
						</div>
						<div class="modal-footer">
							<button type="button" class="btn btn-secondary"
								data-dismiss="modal">Close</button>
							<button type="button" class="btn btn-primary" action="" id="save">Save
								changes</button>
						</div>
					</div>
				</div>
			</div>

			<!-- Footer -->
			<th:block th:replace="/dashboard/fragments :: footer">

    		</th:block>
			<!-- End Footer -->
		</div>
	</main>
	<script src="/asset/dashboard/js/graindashboard.js"></script>
	<script src="/asset/dashboard/js/graindashboard.vendor.js"></script> 
	<script src="https://cdn.jsdelivr.net/npm/handlebars@latest/dist/handlebars.js"></script>
	
    
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/js/bootstrap.min.js"
      integrity="sha384-+YQ4JLhjyBLPDQt//I+STsc9iw4uQqACwlvpslubQzn4u2UU2UFM80nGisd026JF"
      crossorigin="anonymous"
    ></script>
    
    <!-- Validation -->
	<script src="http://ajax.aspnetcdn.com/ajax/jquery.validate/1.11.1/jquery.validate.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-validate/1.19.3/jquery.validate.min.js" integrity="sha512-37T7leoNS06R80c8Ulq7cdCDU5MNQBwlYoy1TX/WUsLFC2eYNqtKlV0QjH7r8JpG/S0GUMZwebnVFLPd6SU5yg==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-validate/1.19.3/additional-methods.min.js" integrity="sha512-XZEy8UQ9rngkxQVugAdOuBRDmJ5N4vCuNXCh8KlniZgDKTvf7zl75QBtaVG1lEhMFe2a2DuA22nZYY+qsI2/xA==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
		<script src="https://cdn.jsdelivr.net/npm/form-data-json-convert/dist/form-data-json.min.js"></script>


	<script type="text/javascript">
		var url = "/api/thuonghieu";

		var token = sessionStorage.getItem("jwtToken");
		var rowTemplate = "{{#each thuonghieus}}"
							+"<tr>"
							+       '<td class="py-3">{{tenTH}}</td>'
							+       '<td class="py-3"><button class="edit btn btn-outline" c-id="{{idTH}}"><i class="gd-pencil-alt"></i></button>'
							+ 		'<button class="delete btn btn-outline" c-id="{{idTH}}"><i class="gd-trash"></i></button></td>'
							
							+"</tr>"
						+"{{/each}}";
		var rowHbs = Handlebars.compile(rowTemplate);
		
		function loadList() {
			fetch(url, {
				method: 'GET',
		        headers: {
		            'Content-Type': 'application/json',
					'Authorization': 'Bearer ' + token
	          	}
			}).then(res => res.json())
				.then(data => {
					var rows = rowHbs({ thuonghieus: data });
					$("#tableBody").html(rows);
					bindEvent();
					bindClick()
				});
		}
		loadList();
		
		function bindEvent() {
			$(".delete").click(function() {
				deletethuonghieu($(this));
			});
		}
		
		var insertModal = new bootstrap.Modal(document.getElementById('editModal'), {
			  keyboard: false
			});
		$("#them").click(function() {
			insertModal.show();
			var insertForm = '<div class="mb-3">'
	               +	'<label for="tenTH" class="form-label"><b>Tên thương hiệu:</b></label>'
	  			   +	'<input name="tenTH" value="" class="form-control" id="tenTH" placeholder="Tên thương hiệu">'
					+   '</div>';
			$("#editForm").html(insertForm);
		});
		
		$("#save").click(function() {
			var thuonghieu = FormDataJson.toJson(document.querySelector("#editModal"));;
			var editOption = {
		        method: 'POST',
		        headers: {
		            'Content-Type': 'application/json',
					'Authorization': 'Bearer ' + token
	          	},
		        body: JSON.stringify(thuonghieu)
			};
			thuonghieu = fetch(url, editOption)
					.then(response => response.json())
					.then(data => {
						console.log(data);
						loadList();
					});
			insertModal.hide();
		});
		
		// thực hiện delete
		function deletethuonghieu($button) {
	    var id = $button.attr("c-id");
	    alert("id saa pham la" + id)
	    var deleteOption = {
	        method: 'delete',
	        headers: {
	            'Content-Type': 'application/json',
				'Authorization': 'Bearer ' + token
	        }
	    };
	    thuonghieus = fetch(url + "/" + id, deleteOption)
	        .then(response => {
	            loadList();
	        });

	}
		var editTemplateStr = '<input type="hidden" name="idTH" id-cate = "idTH" value = "{{idTH}}">' +
        '<div class="mb-3">' +
        '<label for="tenTH" class="form-label"><b>Tên thương hiệu</b></label>' +
        '<input name="tenTH" value="{{tenTH}}" class="form-control" id="tenTH" placeholder="Tên thương hiệu">' +
        '</div>';
    	var editHbs = Handlebars.compile(editTemplateStr);
    	function bindClick() {
            $(".edit").click(function() {
                insertModal.show();
                var id = $(this).attr("c-id");
                fetch(url + "/" + id, {

				})
                    .then(res => res.json())
                    .then(data => {
                        var editHtml = editHbs(data);
                        $("#editForm").html(editHtml);
                    })
            })
        }
	</script>

	
</body>
</html>